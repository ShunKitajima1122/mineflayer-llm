"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.monkeyPatch = exports.loader = exports.createPlugin = void 0;
const tween_js_1 = __importDefault(require("@tweenjs/tween.js"));
const smoothLook_1 = require("./smoothLook");
/**
 * Utility function to create a plugin for mineflayer bots.
 *
 * This can be used for easy access to settings on the bot, in case you want to customize things.
 */
function createPlugin(opts) {
    return (bot) => {
        loader(bot);
        if (opts.easingFunction) {
            bot.smoothLook.setEasing(opts.easingFunction);
        }
        if (opts.turnRateModifier) {
            bot.physics.yawSpeed *= opts.turnRateModifier;
            bot.physics.pitchSpeed *= opts.turnRateModifier;
        }
        if (opts.debug) {
            bot.smoothLook.debug = opts.debug;
        }
        if (opts.goodEnoughDot) {
            bot.smoothLook.goodEnoughDot = opts.goodEnoughDot;
        }
    };
}
exports.createPlugin = createPlugin;
/**
 * Default loader function for the smoothLook plugin.
 * @param bot The bot to load the smoothLook plugin on.
 */
function loader(bot) {
    bot.smoothLook = new smoothLook_1.SmoothLook(bot);
    bot.on("physicsTick", () => {
        tween_js_1.default.update();
    });
}
exports.loader = loader;
function monkeyPatch(bot) {
    if (!bot.smoothLook) {
        console.warn('smoothLook was not loaded yet!');
        loader(bot);
    }
    bot.lookAt = (point, force) => {
        return bot.smoothLook.lookAt(point, true);
    };
    bot.look = (yaw, pitch, force) => {
        return bot.smoothLook.look(yaw, pitch, true);
    };
}
exports.monkeyPatch = monkeyPatch;
